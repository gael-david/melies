<%- include('partials/head') %> 
<%- include('partials/header') %> 


<main>
    <h2 class="sectionTitle centerTitle">Top <%= genreName %>  films</h2>
    <div id="resultsWrapper">
        <% for( let index = 0; index < genreFilms.results.length; index++ ) { %>
            <div class="smallFilmComponent resultsComponent">
                <a href="/film/<%= genreFilms.results[index].id %> ">
                    <% if (genreFilms.results[index].poster_path) { %>
                        <img class="smallFilmPoster" src="https://image.tmdb.org/t/p/w400<%= genreFilms.results[index].poster_path %>" alt="" loading="lazy">
                    <% } else { %>
                        <img class="smallFilmPoster" src="/images/noposter.jpeg" alt="" loading="lazy">
                    <% } %>
                </a>
                <div class="buttonsWrapper smallButtonsWrapper">
                    <div class="ratingWrapper smallRatingWrapper" style="display: none;">
                        <div data-title="masterpiece" data-img="üçæ" class="ratingComponent smallratingComponent"><div class="tooltiptext smallTooltiptext">Masterpiece</div>üçæ</div>
                        <div data-title="excellent" data-img="üëè" class="ratingComponent smallratingComponent"><span class="tooltiptext smallTooltiptext">Excellent</span>üëè</div>
                        <div data-title="goodMoment" data-img="üëç" class="ratingComponent smallratingComponent"><span class="tooltiptext smallTooltiptext">Correct</span>üëç</div>
                        <div data-title="disapointing" data-img="üëé" class="ratingComponent smallratingComponent"><span class="tooltiptext smallTooltiptext">Disapointing</span>üëé</div>
                        <div data-title="purge" data-img="ü•±" class="ratingComponent smallratingComponent"><span class="tooltiptext smallTooltiptext">Dud</span>ü•±</div>
                        <div idata-title="nanar" data-img="üí∏" class="ratingComponent smallratingComponent"><span class="tooltiptext smallTooltiptext">Nanar</span>üí∏</div>
                    </div>
    
                    <button class="ratingButton roundButton smallRoundButton" type="submit">
                        <span class="material-icons-outlined">grade</span>
                    </button>
                    <% if (watchlist.some(e => e.id === genreFilms.results[index].id )) { %>
                        <form action="/watchlist?_method=DELETE" method="POST" id="removeWatchlistForm">
                            <button id="removeWatchlistButton" class="roundButton smallRoundButton" name="id" value="<%= genreFilms.results[index].id  %>" type="submit">
                                <span class="material-icons favorite">bookmark_added</span>
                            </button>
                        </form>
                    <% } else { %>
                    <form action="/watchlist?_method=PUT" method="POST" id="addWatchlistForm">
                        <input type="hidden" id="id" name="id" value="<%= genreFilms.results[index].id  %>">
                        <input type="hidden" id="title" name="title" value="<%= genreFilms.results[index].title  %>">
                        <input type="hidden" id="release_date" name="release_date" value="<%= genreFilms.results[index].release_date.slice(0,4)  %>">
                        <input type="hidden" id="poster_path" name="poster_path" value="<%= genreFilms.results[index].poster_path %>">
                        <button type="submit" id="addWatchlistButton" class="roundButton smallRoundButton"><span class="material-icons">bookmark_border</span></button>
                    </form>
                    <% } %>
                </div>
    
                <p><span><%= genreFilms.results[index].title %></span> 
                    <% if (genreFilms.results[index].release_date) { %>
                        (<%= genreFilms.results[index].release_date.slice(0,4) %>)</p>
                    <% } %>
            </div>
        <% } %>
    </div>
    <h2 class="centerTitle"> Page <%= genrePage %></h2>
        <div class="pageWrapper">
            <% if (+genrePage !== 1) { %>
                <a class="button pageButton" href="/film/genre/<%= genreID %>/<%= +genrePage - 1 %>">Previous</a>
            <% } %>
            <a class="button pageButton" href="/film/genre/<%= genreID %>/<%= +genrePage + 1 %>">Next</a>
        </div>
</main>

<%- include('partials/footer') %> 