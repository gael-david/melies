<%- include('partials/head') %> 
<%- include('partials/header') %> 

<main>
<h2 class="sectionTitle centerTitle">Search results for "<%= q %>": </h2>
<div id="resultsWrapper">
    <% for( let index = 0; index < searchedFilms.results.length; index++ ) { %>
        <div class="smallFilmComponent resultsComponent">
            <a href="/film/<%= searchedFilms.results[index].id %> ">
                <% if (searchedFilms.results[index].poster_path) { %>
                    <img class="smallFilmPoster" src="https://image.tmdb.org/t/p/w400<%= searchedFilms.results[index].poster_path %>" alt="" loading="lazy">
                <% } else { %>
                    <img class="smallFilmPoster" src="/images/noposter.jpeg" alt="" loading="lazy">
                <% } %>
            </a>
            <div class="buttonsWrapper smallButtonsWrapper">
                <div class="ratingWrapper smallRatingWrapper" style="display: none;">
                    <div data-title="masterpiece" data-img="ğŸ¾" class="ratingComponent smallratingComponent"><div class="tooltiptext smallTooltiptext">Masterpiece</div>ğŸ¾</div>
                    <div data-title="excellent" data-img="ğŸ‘" class="ratingComponent smallratingComponent"><span class="tooltiptext smallTooltiptext">Excellent</span>ğŸ‘</div>
                    <div data-title="goodMoment" data-img="ğŸ‘" class="ratingComponent smallratingComponent"><span class="tooltiptext smallTooltiptext">Correct</span>ğŸ‘</div>
                    <div data-title="disapointing" data-img="ğŸ‘" class="ratingComponent smallratingComponent"><span class="tooltiptext smallTooltiptext">Disapointing</span>ğŸ‘</div>
                    <div data-title="purge" data-img="ğŸ¥±" class="ratingComponent smallratingComponent"><span class="tooltiptext smallTooltiptext">Dud</span>ğŸ¥±</div>
                    <div idata-title="nanar" data-img="ğŸ’¸" class="ratingComponent smallratingComponent"><span class="tooltiptext smallTooltiptext">Nanar</span>ğŸ’¸</div>
                </div>

                <button class="ratingButton roundButton smallRoundButton" type="submit">
                    <span class="material-icons-outlined">grade</span>
                </button>
                <!-- <% if (watchlist.includes(searchedFilms.results[index].id )) { %>
                    <form action="/watchlist?_method=DELETE" method="POST" id="removeWatchlistForm">
                        <button id="removeWatchlistButton" class="roundButton smallRoundButton" name="id" value="<%= searchedFilms.results[index].id  %>" type="submit">
                            <span class="material-icons favorite">bookmark_added</span>
                        </button>
                    </form>
                <% } else { %>
                <form action="/watchlist?_method=PUT" method="POST" id="addWatchlistForm">
                    <button id="addWatchlistButton" class="roundButton smallRoundButton" name="id" value="<%= searchedFilms.results[index].id  %>" type="submit">
                        <span class="material-icons">bookmark_border</span>
                    </button>
                </form>
                <% } %> -->

                <% if (watchlist.some(e => e.id === searchedFilms.results[index].id )) { %>
                    <form action="/watchlist?_method=DELETE" method="POST" id="removeWatchlistForm">
                        <button id="removeWatchlistButton" class="roundButton smallRoundButton" name="id" value="<%= searchedFilms.results[index].id  %>" type="submit">
                            <span class="material-icons favorite">bookmark_added</span>
                        </button>
                    </form>
                <% } else { %>
                <form action="/watchlist?_method=PUT" method="POST" id="addWatchlistForm">
                    <input type="hidden" id="id" name="id" value="<%= searchedFilms.results[index].id  %>">
                    <input type="hidden" id="title" name="title" value="<%= searchedFilms.results[index].title  %>">
                    <input type="hidden" id="release_date" name="release_date" value="<%= searchedFilms.results[index].release_date.slice(0,4)  %>">
                    <input type="hidden" id="poster_path" name="poster_path" value="<%= searchedFilms.results[index].poster_path %>">
                    <button type="submit" id="addWatchlistButton" class="roundButton smallRoundButton"><span class="material-icons">bookmark_border</span></button>
                </form>
                <% } %>

            </div>

            <p><span><%= searchedFilms.results[index].title %></span> 
                <% if (searchedFilms.results[index].release_date) { %>
                    (<%= searchedFilms.results[index].release_date.slice(0,4) %>)</p>
                <% } %>
        </div>
    <% } %>
</div>
</main>


<%- include('partials/footer') %> 